<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ihappy.partner.infrastructure.repo.mybatis.mapper.BaseinfoCompanyPartnerMapper">
    <resultMap id="BaseResultMap" type="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sat Mar 31 13:47:34 CST 2018.
        -->
        <result column="partner_id" property="partnerId"/>
        <result column="partner_comp_id" property="partnerCompId"/>
        <result column="partner_name" property="partnerName"/>
        <result column="is_favor" jdbcType="BIT" property="isFavor"/>
        <result column="comp_id" property="compId"/>
        <result column="comp_name" property="compName"/>
        <result column="partner_level_id" property="partnerLevelId"/>
        <result column="partner_memo" property="partnerMemo"/>
        <result column="partner_type" jdbcType="BIT" property="partnerType"/>
        <result column="sort" property="sort"/>
        <result column="version" property="version"/>
        <result column="partner_arrears" property="partnerArrears"/>
        <result column="partner_discount" property="partnerDiscount"/>
        <result column="mobile" property="mobile"/>
        <result column="created_at" property="createdAt"/>
        <result column="updated_at" property="updatedAt"/>
        <result column="created_person_id" property="createdPersonId"/>
        <result column="updated_person_id" property="updatedPersonId"/>
        <result column="is_deleted" jdbcType="BIT" property="isDeleted"/>
        <result column="partner_linkman" property="partnerLinkman"/>
        <result column="province" property="province"/>
        <result column="city" property="city"/>
        <result column="zone" property="zone"/>
        <result column="partner_address" property="partnerAddress"/>
        <result column="bank_name" property="bankName"/>
        <result column="bank_account_name" property="bankAccountName"/>
        <result column="bank_account_number" property="bankAccountNumber"/>
        <result column="mail" property="mail"/>
        <result column="fax" property="fax"/>
        <result column="head_portrait_address" property="headPortraitAddress"/>
        <result column="tel" property="tel"/>
        <result column="last_contact_time" property="lastContactTime"/>
        <result column="consumption_times" property="consumptionTimes"/>
        <result column="wechat_nickname" property="wechatNickname"/>
        <result column="forbidden" property="forbidden"/>
        <result column="member_no" property="memberNo"/>
        <result column="shopping_guide_id" property="shoppingGuideId"/>
        <result column="store_id" property="storeId"/>
        <result column="sex" property="sex"/>
        <result column="birthday" property="birthday"/>
        <result column="is_can_edit" property="isCanEdit"/>
        <result column="is_default" property="isDefault"/>
        <result column="due_amount" property="dueAmount"/>
        <result column="ontheway_number" property="onthewayNumber"/>
        <result column="total_number" property="totalNumber"/>
        <result column="order_count" property="orderCount"/>
        <result column="debt_date" property="debtDate"/>
        <result column="prepaid_deposit" property="prepaidDeposit"/>
        <result column="wechat_account_name" property="wechatAccountName"/>
        <result column="seller_refund_times" property="sellerRefundTimes"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sat Mar 31 13:47:34 CST 2018.
        -->
        partner_id, partner_comp_id, partner_name, is_favor, comp_id, comp_name, partner_level_id,
        partner_memo, partner_type, sort, version, partner_arrears, partner_discount, mobile,
        created_at, updated_at, created_person_id, updated_person_id, is_deleted, partner_linkman,
        province, city, zone, partner_address, bank_name, bank_account_name, bank_account_number,
        mail, fax,head_portrait_address,tel,last_contact_time,consumption_times,wechat_nickname,
        forbidden,member_no,shopping_guide_id,store_id,sex,birthday, is_can_edit,is_default,
        due_amount,ontheway_number,total_number,order_count,debt_date,prepaid_deposit,wechat_account_name,seller_refund_times
    </sql>
    <select id="selectPartnerCheckPage" parameterType="java.util.Map" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where comp_id = #{compId} and is_deleted = 0
        and not(order_count = 0 and partner_arrears = 0 and prepaid_deposit = 0 and ontheway_number = 0 and forbidden =
        1)
        <if test="partnerType != null">
            and partner_type = #{partnerType}
        </if>
        <if test="searchStr != null and searchStr != ''">
            and (mobile like CONCAT('%',#{searchStr},'%') OR partner_name like CONCAT('%',#{searchStr},'%'))
        </if>
        <if test="order != null and order != ''">
            order by ${order}
            <if test="sort != null and sort == 'desc'">
                desc
            </if>
        </if>
        limit #{limit} offset #{offset}
    </select>

    <select id="selectPartnerCheckPageCount" parameterType="java.util.Map" resultType="java.lang.Integer">
        select count(*) from baseinfo_company_partner where comp_id = #{compId} and is_deleted = 0
        and not(order_count = 0 and partner_arrears = 0 and prepaid_deposit = 0 and ontheway_number = 0 and forbidden =
        1)
        <if test="partnerType != null">
            and partner_type = #{partnerType}
        </if>
        <if test="searchStr != null and searchStr != ''">
            and (mobile like CONCAT('%',#{searchStr},'%') OR partner_name like CONCAT('%',#{searchStr},'%'))
        </if>
    </select>

    <select id="selectPartnerStatistics" resultType="com.ihappy.partner.domain.bo.partner.PartnerBO"
            parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        SELECT count(*) totalPartnerNum,sum(total_number) totalNumber,sum(due_amount) dueAmount,sum(if(partner_arrears >
        0,partner_arrears,0)) partnerArrears,sum(ontheway_number) onthewayNumber,sum(prepaid_deposit) prepaidDeposit,
        count(if(partner_arrears > 0,true,null)) partnerArrearsNum,count(if(ontheway_number > 0,true,null))
        onthewayPartnerNumber,count(if(prepaid_deposit > 0,true,null)) prepaidDepositNum
        FROM baseinfo_company_partner where comp_id = #{compId} and partner_type = #{partnerType} and is_deleted = 0
        <if test="searchStr != null and searchStr != ''">
            and (mobile like CONCAT('%',#{searchStr},'%') OR partner_name like CONCAT('%',#{searchStr},'%'))
        </if>
    </select>
    <update id="updateLastContactTime" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        update baseinfo_company_partner
        <set>
            last_contact_time = #{lastContactTime},
            consumption_times = consumption_times + 1,
        </set>
        where partner_id = #{partnerId} and comp_id = #{compId} and is_deleted = 0
    </update>

    <update id="updatePartnerArrearsByOrder" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        update baseinfo_company_partner
        <set>
            updated_at = #{updatedAt},
            <if test="partnerArrears != null">
                partner_arrears = #{partnerArrears} + partner_arrears,
            </if>
            <if test="prepaidDeposit != null">
                prepaid_deposit = #{prepaidDeposit} + prepaid_deposit,
            </if>
        </set>
        where partner_id = #{partnerId} and comp_id = #{compId} and is_deleted = 0
    </update>

    <select id="selectListByPartnerLevelId" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner"
            resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where partner_level_id = #{partnerLevelId} and is_deleted = 0
    </select>

    <select id="selectCountByPartnerLevelId" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner"
            resultType="java.lang.Integer">
    select
    count(*)
    from baseinfo_company_partner where partner_level_id = #{partnerLevelId} and is_deleted = 0
  </select>

    <select id="selectListByProviderInfoQueryRespDTO"
            parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where partner_type = 0 and is_deleted = 0
        and comp_id = #{compId}
        <if test="isDefault != null">
            and is_default = #{isDefault}
        </if>
        <if test="searchStr != null and searchStr != ''">
            and (mobile like CONCAT(#{searchStr},'%') OR partner_name like CONCAT(#{searchStr},'%'))
        </if>
        ORDER by updated_at desc
    </select>

    <select id="selectListByCustomerInfoQueryRespDTO"
            parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where partner_type = 1 and is_deleted = 0
        and comp_id = #{compId}
        <if test="isDefault != null">
            and is_default = #{isDefault}
        </if>
        <if test="searchStr != null and searchStr != ''">
            and (mobile like CONCAT(#{searchStr},'%') OR partner_linkman like CONCAT(#{searchStr},'%') OR partner_name
            like CONCAT(#{searchStr},'%'))
        </if>
        ORDER by updated_at desc
    </select>

    <select id="selectSelective" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner"
            resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where is_deleted = 0
        <if test="partnerId != null">
            and partner_id = #{partnerId}
        </if>
        <if test="partnerCompId != null">
            and partner_comp_id = #{partnerCompId}
        </if>
        <if test="partnerName != null">
            and partner_name = #{partnerName}
        </if>
        <if test="isFavor != null">
            and is_favor = #{isFavor}
        </if>
        <if test="compId != null">
            and comp_id = #{compId}
        </if>
        <if test="compName != null">
            and comp_name = #{compName}
        </if>
        <if test="partnerLevelId != null">
            and partner_level_id = #{partnerLevelId}
        </if>
        <if test="partnerMemo != null">
            and partner_memo = #{partnerMemo}
        </if>
        <if test="partnerType != null">
            and partner_type = #{partnerType}
        </if>
        <if test="sort != null">
            and sort = #{sort}
        </if>
        <if test="version != null">
            and version = #{version}
        </if>
        <if test="partnerArrears != null">
            and partner_arrears = #{partnerArrears}
        </if>
        <if test="partnerDiscount != null">
            and partner_discount = #{partnerDiscount}
        </if>
        <if test="mobile != null">
            and mobile = #{mobile}
        </if>
        <if test="createdAt != null">
            and created_at = #{createdAt}
        </if>
        <if test="updatedAt != null">
            and updated_at = #{updatedAt}
        </if>
        <if test="createdPersonId != null">
            and created_person_id = #{createdPersonId}
        </if>
        <if test="createdPersonId != null">
            and created_person_id = #{createdPersonId}
        </if>
        <if test="updatedPersonId != null">
            and updated_person_id = #{updatedPersonId}
        </if>
        <if test="isDeleted != null">
            and is_deleted = #{isDeleted}
        </if>
        <if test="partnerLinkman != null">
            and partner_linkman = #{partnerLinkman}
        </if>
        <if test="province != null">
            and province = #{province}
        </if>
        <if test="city != null">
            and city = #{city}
        </if>
        <if test="zone != null">
            and zone = #{zone}
        </if>
        <if test="partnerAddress != null">
            and partner_address = #{partnerAddress}
        </if>
        <if test="bankName != null">
            and bank_name = #{bankName}
        </if>
        <if test="bankAccountName != null">
            and bank_account_name = #{bankAccountName}
        </if>
        <if test="bankAccountNumber != null">
            and bank_account_number = #{bankAccountNumber}
        </if>
        <if test="mail != null">
            and mail = #{mail}
        </if>
        <if test="fax != null">
            and fax = #{fax}
        </if>
        <if test="headPortraitAddress != null">
            and head_portrait_address = #{headPortraitAddress}
        </if>
        <if test="tel != null">
            and tel = #{tel}
        </if>
        <if test="lastContactTime != null">
            and last_contact_time = #{lastContactTime}
        </if>
        <if test="consumptionTimes != null">
            and consumption_times = #{consumptionTimes}
        </if>
        <if test="wechatNickname != null">
            and wechat_nickname = #{wechatNickname}
        </if>
        <if test="forbidden != null">
            and forbidden = #{forbidden}
        </if>
        <if test="memberNo != null">
            and member_no = #{memberNo}
        </if>
        <if test="shoppingGuideId != null">
            and shopping_guide_id = #{shoppingGuideId}
        </if>
        <if test="storeId != null">
            and store_id = #{storeId}
        </if>
        <if test="sex != null">
            and sex = #{sex}
        </if>
        <if test="birthday != null">
            and birthday = #{birthday}
        </if>
        <if test="isCanEdit != null">
            and is_can_edit = #{isCanEdit}
        </if>
        <if test="isDefault != null">
            and is_default = #{isDefault}
        </if>
        <if test="dueAmount != null">
            and due_amount = #{dueAmount}
        </if>
        <if test="onthewayNumber != null">
            and ontheway_number = #{onthewayNumber}
        </if>
        <if test="totalNumber != null">
            and total_number = #{totalNumber}
        </if>
        <if test="orderCount != null">
            and order_count = #{orderCount}
        </if>
        <if test="debtDate != null">
            and debt_date = #{debtDate}
        </if>
        <if test="prepaidDeposit != null">
            and prepaid_deposit = #{prepaidDeposit}
        </if>
    </select>

    <select id="selectByCondition" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner"
            resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where 1 = 1
        <if test="compId != null">
            and comp_id = #{compId}
        </if>
        <if test="partnerId != null">
            and partner_id = #{partnerId}
        </if>
        <if test="partnerCompId != null">
            and partner_comp_id = #{partnerCompId}
        </if>
        <if test="partnerName != null">
            and partner_name = #{partnerName}
        </if>
        <if test="isFavor != null">
            and is_favor = #{isFavor}
        </if>
        <if test="compId != null">
            and comp_id = #{compId}
        </if>
        <if test="compName != null">
            and comp_name = #{compName}
        </if>
        <if test="partnerLevelId != null">
            and partner_level_id = #{partnerLevelId}
        </if>
        <if test="partnerMemo != null">
            and partner_memo = #{partnerMemo}
        </if>
        <if test="partnerType != null">
            and partner_type = #{partnerType}
        </if>
        <if test="sort != null">
            and sort = #{sort}
        </if>
        <if test="version != null">
            and version = #{version}
        </if>
        <if test="partnerArrears != null">
            and partner_arrears = #{partnerArrears}
        </if>
        <if test="partnerDiscount != null">
            and partner_discount = #{partnerDiscount}
        </if>
        <if test="mobile != null">
            and mobile = #{mobile}
        </if>
        <if test="createdAt != null">
            and created_at = #{createdAt}
        </if>
        <if test="updatedAt != null">
            and updated_at = #{updatedAt}
        </if>
        <if test="createdPersonId != null">
            and created_person_id = #{createdPersonId}
        </if>
        <if test="createdPersonId != null">
            and created_person_id = #{createdPersonId}
        </if>
        <if test="updatedPersonId != null">
            and updated_person_id = #{updatedPersonId}
        </if>
        <if test="isDeleted != null">
            and is_deleted = #{isDeleted}
        </if>
        <if test="partnerLinkman != null">
            and partner_linkman = #{partnerLinkman}
        </if>
        <if test="province != null">
            and province = #{province}
        </if>
        <if test="city != null">
            and city = #{city}
        </if>
        <if test="zone != null">
            and zone = #{zone}
        </if>
        <if test="partnerAddress != null">
            and partner_address = #{partnerAddress}
        </if>
        <if test="bankName != null">
            and bank_name = #{bankName}
        </if>
        <if test="bankAccountName != null">
            and bank_account_name = #{bankAccountName}
        </if>
        <if test="bankAccountNumber != null">
            and bank_account_number = #{bankAccountNumber}
        </if>
        <if test="mail != null">
            and mail = #{mail}
        </if>
        <if test="fax != null">
            and fax = #{fax}
        </if>
        <if test="headPortraitAddress != null">
            and head_portrait_address = #{headPortraitAddress}
        </if>
        <if test="tel != null">
            and tel = #{tel}
        </if>
        <if test="lastContactTime != null">
            and last_contact_time = #{lastContactTime}
        </if>
        <if test="consumptionTimes != null">
            and consumption_times = #{consumptionTimes}
        </if>
        <if test="wechatNickname != null">
            and wechat_nickname = #{wechatNickname}
        </if>
        <if test="forbidden != null">
            and forbidden = #{forbidden}
        </if>
        <if test="memberNo != null">
            and member_no = #{memberNo}
        </if>
        <if test="shoppingGuideId != null">
            and shopping_guide_id = #{shoppingGuideId}
        </if>
        <if test="storeId != null">
            and store_id = #{storeId}
        </if>
        <if test="sex != null">
            and sex = #{sex}
        </if>
        <if test="birthday != null">
            and birthday = #{birthday}
        </if>
        <if test="isCanEdit != null">
            and is_can_edit = #{isCanEdit}
        </if>
        <if test="isDefault != null">
            and is_default = #{isDefault}
        </if>
        <if test="dueAmount != null">
            and due_amount = #{dueAmount}
        </if>
        <if test="onthewayNumber != null">
            and ontheway_number = #{onthewayNumber}
        </if>
        <if test="totalNumber != null">
            and total_number = #{totalNumber}
        </if>
        <if test="orderCount != null">
            and order_count = #{orderCount}
        </if>
        <if test="debtDate != null">
            and debt_date = #{debtDate}
        </if>
        <if test="prepaidDeposit != null">
            and prepaid_deposit = #{prepaidDeposit}
        </if>
        <if test="isDeleted != null">
            and is_deleted = #{isDeleted}
        </if>
    </select>
  <update id="updatePartnerInfo" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
    update baseinfo_company_partner
    <set>
      <if test="partnerLevelId != null">
        partner_level_id = #{partnerLevelId},
      </if>
      <if test="partnerName != null" >
        partner_name = #{partnerName},
      </if>
      <if test="partnerType != null" >
        partner_type = #{partnerType,jdbcType=BIT},
      </if>
      <if test="mobile != null" >
        mobile = #{mobile},
      </if>
      <if test="updatedAt != null" >
        updated_at = #{updatedAt},
      </if>
      <if test="updatedPersonId != null" >
        updated_person_id = #{updatedPersonId},
      </if>
      <if test="partnerLinkman != null" >
        partner_linkman = #{partnerLinkman},
      </if>
      <if test="province != null" >
        province = #{province},
      </if>
      <if test="city != null" >
        city = #{city},
      </if>
      <if test="zone != null" >
        zone = #{zone},
      </if>
      <if test="partnerAddress != null" >
        partner_address = #{partnerAddress},
      </if>
      <if test="bankName != null" >
        bank_name = #{bankName},
      </if>
      <if test="bankAccountName != null" >
        bank_account_name = #{bankAccountName},
      </if>
      <if test="bankAccountNumber != null" >
        bank_account_number = #{bankAccountNumber},
      </if>
      <if test="mail != null" >
        mail = #{mail},
      </if>
      <if test="fax != null" >
        fax = #{fax},
      </if>
      <if test="partnerMemo != null" >
        partner_memo = #{partnerMemo},
      </if>
      <if test="headPortraitAddress != null" >
        head_portrait_address = #{headPortraitAddress},
      </if>
      <if test="tel != null" >
        tel = #{tel},
      </if>
      <if test="consumptionTimes != null" >
        consumption_times = #{consumptionTimes},
      </if>
      <if test="wechatNickname != null" >
        wechat_nickname = #{wechatNickname},
      </if>
      <if test="forbidden != null" >
        forbidden = #{forbidden},
      </if>
      <if test="memberNo != null" >
        member_no = #{memberNo},
      </if>
      <if test="shoppingGuideId != null" >
        shopping_guide_id = #{shoppingGuideId},
      </if>
      <if test="storeId != null" >
        store_id = #{storeId},
      </if>
      <if test="sex != null" >
        sex = #{sex},
      </if>
      <if test="birthday != null" >
        birthday = #{birthday},
      </if>
      <if test="partnerCompId != null" >
        partner_comp_id = #{partnerCompId},
      </if>
      <if test="dueAmount != null">
        due_amount = #{dueAmount},
      </if>
      <if test="onthewayNumber != null">
        ontheway_number = #{onthewayNumber},
      </if>
      <if test="totalNumber != null">
        total_number = #{totalNumber},
      </if>
      <if test="orderCount != null">
        order_count = #{orderCount},
      </if>
      <if test="debtDate != null">
        debt_date = #{debtDate},
      </if>
      <if test="prepaidDeposit != null">
        prepaid_deposit = #{prepaidDeposit},
      </if>
      <if test="wechatAccountName != null">
        wechat_account_name = #{wechatAccountName},
      </if>
        <if test="sellerRefundTimes != null">
            seller_refund_times = #{sellerRefundTimes}
        </if>
    </set>
    where partner_id = #{partnerId} and comp_id = #{compId} and is_deleted = 0 and is_can_edit = 1
  </update>



    <update id="delCompanyPartner" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        update baseinfo_company_partner
        <set>
            updated_at = #{updatedAt},
            updated_person_id = #{updatedPersonId},
            is_deleted = 1
        </set>
        where partner_id = #{partnerId} and is_deleted = 0 and comp_id = #{compId} and is_can_edit = 1
    </update>
    <update id="forbidRetailCustomer" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        update baseinfo_company_partner
        <set>
            updated_at = #{updatedAt},
            updated_person_id = #{updatedPersonId},
            forbidden = 1
        </set>
        where partner_id = #{partnerId} and is_deleted = 0 and is_can_edit = 1
    </update>

    <update id="unforbidRetailCustomer" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        update baseinfo_company_partner
        <set>
            updated_at = #{updatedAt},
            updated_person_id = #{updatedPersonId},
            forbidden = 0
        </set>
        where partner_id = #{partnerId} and is_deleted = 0  and is_can_edit = 1
    </update>

    <select id="selectFavorByLimit" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where partner_type = #{obj.partnerType} and is_favor = 1 and is_deleted = 0
        and comp_id = #{obj.compId}
        ORDER by last_contact_time desc limit #{limit}
    </select>

    <select id="selectLastContactByLimit" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where partner_type = #{obj.partnerType} and is_deleted = 0
        and comp_id = #{obj.compId}
        ORDER by last_contact_time desc limit #{limit}
    </select>

    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sat Mar 31 13:47:34 CST 2018.
        -->
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner
        where partner_id = #{partnerId} and is_deleted = 0
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sat Mar 31 13:47:34 CST 2018.
        -->
        delete from baseinfo_company_partner
        where partner_id = #{partnerId}
    </delete>
    <insert id="insertSelective" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sat Mar 31 13:47:34 CST 2018.
        -->
        insert into baseinfo_company_partner
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="partnerId != null">
                partner_id,
            </if>
            <if test="partnerCompId != null">
                partner_comp_id,
            </if>
            <if test="partnerName != null">
                partner_name,
            </if>
            <if test="isFavor != null">
                is_favor,
            </if>
            <if test="compId != null">
                comp_id,
            </if>
            <if test="compName != null">
                comp_name,
            </if>
            <if test="partnerLevelId != null">
                partner_level_id,
            </if>
            <if test="partnerMemo != null">
                partner_memo,
            </if>
            <if test="partnerType != null">
                partner_type,
            </if>
            <if test="sort != null">
                sort,
            </if>
            <if test="version != null">
                version,
            </if>
            <if test="partnerArrears != null">
                partner_arrears,
            </if>
            <if test="partnerDiscount != null">
                partner_discount,
            </if>
            <if test="mobile != null">
                mobile,
            </if>
            <if test="createdAt != null">
                created_at,
            </if>
            <if test="updatedAt != null">
                updated_at,
            </if>
            <if test="createdPersonId != null">
                created_person_id,
            </if>
            <if test="updatedPersonId != null">
                updated_person_id,
            </if>
            <if test="isDeleted != null">
                is_deleted,
            </if>
            <if test="partnerLinkman != null">
                partner_linkman,
            </if>
            <if test="province != null">
                province,
            </if>
            <if test="city != null">
                city,
            </if>
            <if test="zone != null">
                zone,
            </if>
            <if test="partnerAddress != null">
                partner_address,
            </if>
            <if test="bankName != null">
                bank_name,
            </if>
            <if test="bankAccountName != null">
                bank_account_name,
            </if>
            <if test="bankAccountNumber != null">
                bank_account_number,
            </if>
            <if test="mail != null">
                mail,
            </if>
            <if test="fax != null">
                fax,
            </if>
            <if test="headPortraitAddress != null">
                head_portrait_address,
            </if>
            <if test="tel != null">
                tel,
            </if>
            <if test="consumptionTimes != null">
                consumption_times,
            </if>
            <if test="wechatNickname != null">
                wechat_nickname,
            </if>
            <if test="forbidden != null">
                forbidden,
            </if>
            <if test="memberNo != null">
                member_no,
            </if>
            <if test="shoppingGuideId != null">
                shopping_guide_id,
            </if>
            <if test="storeId != null">
                store_id,
            </if>
            <if test="sex != null">
                sex,
            </if>
            <if test="birthday != null">
                birthday,
            </if>
            <if test="isCanEdit != null">
                is_can_edit,
            </if>
            <if test="isDefault != null">
                is_default,
            </if>
            <if test="dueAmount != null">
                due_amount,
            </if>
            <if test="onthewayNumber != null">
                ontheway_number,
            </if>
            <if test="totalNumber != null">
                total_number,
            </if>
            <if test="orderCount != null">
                order_count,
            </if>
            <if test="debtDate != null">
                debt_date,
            </if>
            <if test="prepaidDeposit != null">
                prepaid_deposit,
            </if>
            <if test="wechatAccountName != null">
                wechat_account_name,
            </if>
            <if test="sellerRefundTimes != null">
                seller_refund_times,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="partnerId != null">
                #{partnerId},
            </if>
            <if test="partnerCompId != null">
                #{partnerCompId},
            </if>
            <if test="partnerName != null">
                #{partnerName},
            </if>
            <if test="isFavor != null">
                #{isFavor,jdbcType=BIT},
            </if>
            <if test="compId != null">
                #{compId},
            </if>
            <if test="compName != null">
                #{compName},
            </if>
            <if test="partnerLevelId != null">
                #{partnerLevelId},
            </if>
            <if test="partnerMemo != null">
                #{partnerMemo},
            </if>
            <if test="partnerType != null">
                #{partnerType,jdbcType=BIT},
            </if>
            <if test="sort != null">
                #{sort},
            </if>
            <if test="version != null">
                #{version},
            </if>
            <if test="partnerArrears != null">
                #{partnerArrears},
            </if>
            <if test="partnerDiscount != null">
                #{partnerDiscount},
            </if>
            <if test="mobile != null">
                #{mobile},
            </if>
            <if test="createdAt != null">
                #{createdAt},
            </if>
            <if test="updatedAt != null">
                #{updatedAt},
            </if>
            <if test="createdPersonId != null">
                #{createdPersonId},
            </if>
            <if test="updatedPersonId != null">
                #{updatedPersonId},
            </if>
            <if test="isDeleted != null">
                #{isDeleted,jdbcType=BIT},
            </if>
            <if test="partnerLinkman != null">
                #{partnerLinkman},
            </if>
            <if test="province != null">
                #{province},
            </if>
            <if test="city != null">
                #{city},
            </if>
            <if test="zone != null">
                #{zone},
            </if>
            <if test="partnerAddress != null">
                #{partnerAddress},
            </if>
            <if test="bankName != null">
                #{bankName},
            </if>
            <if test="bankAccountName != null">
                #{bankAccountName},
            </if>
            <if test="bankAccountNumber != null">
                #{bankAccountNumber},
            </if>
            <if test="mail != null">
                #{mail},
            </if>
            <if test="fax != null">
                #{fax},
            </if>
            <if test="headPortraitAddress != null">
                #{headPortraitAddress},
            </if>
            <if test="tel != null">
                #{tel},
            </if>
            <if test="consumptionTimes != null">
                #{consumptionTimes},
            </if>
            <if test="wechatNickname != null">
                #{wechatNickname},
            </if>
            <if test="forbidden != null">
                #{forbidden},
            </if>
            <if test="memberNo != null">
                #{memberNo},
            </if>
            <if test="shoppingGuideId != null">
                #{shoppingGuideId},
            </if>
            <if test="storeId != null">
                #{storeId},
            </if>
            <if test="sex != null">
                #{sex},
            </if>
            <if test="birthday != null">
                #{birthday},
            </if>
            <if test="isCanEdit != null">
                #{isCanEdit},
            </if>
            <if test="isDefault != null">
                #{isDefault},
            </if>
            <if test="dueAmount != null">
                #{dueAmount},
            </if>
            <if test="onthewayNumber != null">
                #{onthewayNumber},
            </if>
            <if test="totalNumber != null">
                #{totalNumber},
            </if>
            <if test="orderCount != null">
                #{orderCount},
            </if>
            <if test="debtDate != null">
                #{debtDate},
            </if>
            <if test="prepaidDeposit != null">
                #{prepaidDeposit},
            </if>
            <if test="wechatAccountName != null">
                #{wechatAccountName},
            </if>
            <if test="sellerRefundTimes != null">
                #{sellerRefundTimes},
            </if>
        </trim>
    </insert>

    <update id="updateByPrimaryKeySelective" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sat Mar 31 13:47:34 CST 2018.
        -->
        update baseinfo_company_partner
        <set>
            <if test="partnerCompId != null">
                partner_comp_id = #{partnerCompId},
            </if>
            <if test="partnerName != null">
                partner_name = #{partnerName},
            </if>
            <if test="isFavor != null">
                is_favor = #{isFavor,jdbcType=BIT},
            </if>
            <if test="compId != null">
                comp_id = #{compId},
            </if>
            <if test="compName != null">
                comp_name = #{compName},
            </if>
            <if test="partnerLevelId != null">
                partner_level_id = #{partnerLevelId},
            </if>
            <if test="partnerMemo != null">
                partner_memo = #{partnerMemo},
            </if>
            <if test="partnerType != null">
                partner_type = #{partnerType,jdbcType=BIT},
            </if>
            <if test="sort != null">
                sort = #{sort},
            </if>
            <if test="version != null">
                version = #{version},
            </if>
            <if test="partnerArrears != null">
                partner_arrears = #{partnerArrears},
            </if>
            <if test="partnerDiscount != null">
                partner_discount = #{partnerDiscount},
            </if>
            <if test="mobile != null">
                mobile = #{mobile},
            </if>
            <if test="createdAt != null">
                created_at = #{createdAt},
            </if>
            <if test="updatedAt != null">
                updated_at = #{updatedAt},
            </if>
            <if test="createdPersonId != null">
                created_person_id = #{createdPersonId},
            </if>
            <if test="updatedPersonId != null">
                updated_person_id = #{updatedPersonId},
            </if>
            <if test="isDeleted != null">
                is_deleted = #{isDeleted,jdbcType=BIT},
            </if>
            <if test="partnerLinkman != null">
                partner_linkman = #{partnerLinkman},
            </if>
            <if test="province != null">
                province = #{province},
            </if>
            <if test="city != null">
                city = #{city},
            </if>
            <if test="zone != null">
                zone = #{zone},
            </if>
            <if test="partnerAddress != null">
                partner_address = #{partnerAddress},
            </if>
            <if test="bankName != null">
                bank_name = #{bankName},
            </if>
            <if test="bankAccountName != null">
                bank_account_name = #{bankAccountName},
            </if>
            <if test="bankAccountNumber != null">
                bank_account_number = #{bankAccountNumber},
            </if>
            <if test="mail != null">
                mail = #{mail},
            </if>
            <if test="fax != null">
                fax = #{fax},
            </if>
            <if test="headPortraitAddress != null">
                head_portrait_address = #{headPortraitAddress},
            </if>
            <if test="consumptionTimes != null">
                consumption_times = #{consumptionTimes},
            </if>
            <if test="wechatNickname != null">
                wechat_nickname = #{wechatNickname},
            </if>
            <if test="forbidden != null">
                forbidden = #{forbidden},
            </if>
            <if test="memberNo != null">
                member_no = #{memberNo},
            </if>
            <if test="shoppingGuideId != null">
                shopping_guide_id = #{shoppingGuideId},
            </if>
            <if test="storeId != null">
                store_id = #{storeId},
            </if>
            <if test="sex != null">
                sex = #{sex},
            </if>
            <if test="birthday != null">
                birthday = #{birthday},
            </if>
            <if test="dueAmount != null">
                due_amount = #{dueAmount},
            </if>
            <if test="onthewayNumber != null">
                ontheway_number = #{onthewayNumber},
            </if>
            <if test="totalNumber != null">
                total_number = #{totalNumber},
            </if>
            <if test="orderCount != null">
                order_count = #{orderCount},
            </if>
            <if test="debtDate != null">
                debt_date = #{debtDate},
            </if>
            <if test="prepaidDeposit != null">
                prepaid_deposit = #{prepaidDeposit},
            </if>
            <if test="wechatAccountName != null">
                wechat_account_name = #{wechatAccountName},
            </if>
            <if test="sellerRefundTimes != null">
                seller_refund_times = #{sellerRefundTimes}
            </if>
        </set>
        where partner_id = #{partnerId} and is_deleted = 0 and is_can_edit = 1
    </update>

    <select id="getProviderInfoInsideQuery" resultMap="BaseResultMap"
            parameterType="com.ihappy.partner.domain.dto.request.partner.ProviderInfoInsideQueryReqDTO">
        SELECT
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where is_deleted = 0 and comp_id = #{compId} and partner_comp_id =
        #{partnerCompId} and partner_type = #{partnerType}
    </select>

    <select id="selectPartner" resultMap="BaseResultMap"
            parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        SELECT
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where partner_id = #{partnerId} and comp_id = #{compId} and is_deleted = 0
    </select>

    <select id="selectPartnerPageByCondition" resultMap="BaseResultMap"
            parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        SELECT
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where comp_id = #{compId} and is_deleted = 0 and partner_type = #{partnerType}
        <if test="forbidden != null">
            and forbidden = #{forbidden}
        </if>
        <if test="isDefault != null">
            and is_default = #{isDefault}
        </if>
        <if test="storeIds != null and storeIds.size > 0">
            and store_id in
            <foreach collection="storeIds" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="shoppingGuideId != null">
            and shopping_guide_id = #{shoppingGuideId}
        </if>
        <if test="searchStr != null and searchStr != ''">
            and (mobile like CONCAT(#{searchStr},'%') OR partner_name like CONCAT(#{searchStr},'%'))
        </if>
        ORDER BY partner_linkman limit #{limit} offset #{offset}
    </select>

    <select id="selectPartnerPageByConditionCount" resultType="java.lang.Integer"
            parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">
        SELECT count(*) from
        (
        SELECT
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where comp_id = #{compId} and is_deleted = 0 and partner_type = #{partnerType}
        <if test="forbidden != null">
            and forbidden = #{forbidden}
        </if>
        <if test="isDefault != null">
            and is_default = #{isDefault}
        </if>
        <if test="storeIds != null and storeIds.size > 0">
            and store_id in
            <foreach collection="storeIds" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="shoppingGuideId != null">
            and shopping_guide_id = #{shoppingGuideId}
        </if>
        <if test="searchStr != null and searchStr != ''">
            and (mobile like CONCAT(#{searchStr},'%') OR partner_name like CONCAT(#{searchStr},'%'))
        </if>
        ) t
    </select>
    <select id="selectPartnerPageByCompId" parameterType="com.ihappy.partner.domain.bo.partner.QueryPartnerBO"
            resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner
        where comp_id=#{compId} and is_deleted = 0 and partner_type = #{partnerType}
        <if test="filterIsDefault != null and filterIsDefault == true">
            and is_default = 0
        </if>
        <if test="filterIsForbid != null and filterIsForbid == true">
            and forbidden = 0
        </if>
        <if test="searchStr != null and searchStr != ''">
            and (mobile like concat(#{searchStr},'%') or partner_name like concat(#{searchStr},'%'))
        </if>
        ORDER BY forbidden asc , updated_at desc
        limit #{limit} offset #{offset}
    </select>
    <select id="selectPartnerPageByCompIdCount" parameterType="com.ihappy.partner.domain.bo.partner.QueryPartnerBO"
            resultType="java.lang.Integer">
        select
        count(*)
        from baseinfo_company_partner
        where comp_id = #{compId} and is_deleted = 0 and partner_type = #{partnerType}
        <if test="filterIsDefault != null and filterIsDefault == true">
            and is_default = 0
        </if>
        <if test="filterIsForbid != null and filterIsForbid == true">
            and forbidden = 0
        </if>
        <if test="searchStr != null and searchStr != ''">
            and (mobile like concat(#{searchStr},'%') or partner_name like concat(#{searchStr},'%'))
        </if>
    </select>
    <update id="forceUpdateByPrimaryKeySelective" parameterType="com.ihappy.partner.domain.dbdo.BaseinfoCompanyPartner">

        update baseinfo_company_partner
        <set>
            <if test="partnerCompId != null">
                partner_comp_id = #{partnerCompId},
            </if>
            <if test="partnerName != null">
                partner_name = #{partnerName},
            </if>
            <if test="isFavor != null">
                is_favor = #{isFavor,jdbcType=BIT},
            </if>
            <if test="compId != null">
                comp_id = #{compId},
            </if>
            <if test="compName != null">
                comp_name = #{compName},
            </if>
            <if test="partnerLevelId != null">
                partner_level_id = #{partnerLevelId},
            </if>
            <if test="partnerMemo != null">
                partner_memo = #{partnerMemo},
            </if>
            <if test="partnerType != null">
                partner_type = #{partnerType,jdbcType=BIT},
            </if>
            <if test="sort != null">
                sort = #{sort},
            </if>
            <if test="version != null">
                version = #{version},
            </if>
            <if test="partnerArrears != null">
                partner_arrears = #{partnerArrears},
            </if>
            <if test="partnerDiscount != null">
                partner_discount = #{partnerDiscount},
            </if>
            <if test="mobile != null">
                mobile = #{mobile},
            </if>
            <if test="createdAt != null">
                created_at = #{createdAt},
            </if>
            <if test="updatedAt != null">
                updated_at = #{updatedAt},
            </if>
            <if test="createdPersonId != null">
                created_person_id = #{createdPersonId},
            </if>
            <if test="updatedPersonId != null">
                updated_person_id = #{updatedPersonId},
            </if>
            <if test="isDeleted != null">
                is_deleted = #{isDeleted,jdbcType=BIT},
            </if>
            <if test="partnerLinkman != null">
                partner_linkman = #{partnerLinkman},
            </if>
            <if test="province != null">
                province = #{province},
            </if>
            <if test="city != null">
                city = #{city},
            </if>
            <if test="zone != null">
                zone = #{zone},
            </if>
            <if test="partnerAddress != null">
                partner_address = #{partnerAddress},
            </if>
            <if test="bankName != null">
                bank_name = #{bankName},
            </if>
            <if test="bankAccountName != null">
                bank_account_name = #{bankAccountName},
            </if>
            <if test="bankAccountNumber != null">
                bank_account_number = #{bankAccountNumber},
            </if>
            <if test="mail != null">
                mail = #{mail},
            </if>
            <if test="fax != null">
                fax = #{fax},
            </if>
            <if test="headPortraitAddress != null">
                head_portrait_address = #{headPortraitAddress},
            </if>
            <if test="consumptionTimes != null">
                consumption_times = #{consumptionTimes},
            </if>
            <if test="wechatNickname != null">
                wechat_nickname = #{wechatNickname},
            </if>
            <if test="forbidden != null">
                forbidden = #{forbidden},
            </if>
            <if test="memberNo != null">
                member_no = #{memberNo},
            </if>
            <if test="shoppingGuideId != null">
                shopping_guide_id = #{shoppingGuideId},
            </if>
            <if test="storeId != null">
                store_id = #{storeId},
            </if>
            <if test="sex != null">
                sex = #{sex},
            </if>
            <if test="birthday != null">
                birthday = #{birthday},
            </if>
            <if test="isCanEdit != null">
                is_can_edit = #{isCanEdit},
            </if>
            <if test="isDefault != null">
                is_default = #{isDefault},
            </if>
            <if test="isDeleted != null">
                is_deleted = #{isDeleted},
            </if>
            <if test="dueAmount != null">
                due_amount = #{dueAmount},
            </if>
            <if test="onthewayNumber != null">
                ontheway_number = #{onthewayNumber},
            </if>
            <if test="totalNumber != null">
                total_number = #{totalNumber},
            </if>
            <if test="orderCount != null">
                order_count = #{orderCount},
            </if>
            <if test="debtDate != null">
                debt_date = #{debtDate},
            </if>
            <if test="prepaidDeposit != null">
                prepaid_deposit = #{prepaidDeposit},
            </if>
            <if test="wechatAccountName != null">
                wechat_account_name = #{wechatAccountName},
            </if>
            <if test="sellerRefundTimes != null">
                seller_refund_times = #{sellerRefundTimes}
            </if>
        </set>
        where partner_id = #{partnerId}
    </update>
    <select id="checkMobileIsOrNotRepeat" resultMap="BaseResultMap"
            parameterType="com.ihappy.partner.domain.bo.partner.QueryPartnerBO">
        select
        <include refid="Base_Column_List"/>
        from baseinfo_company_partner where comp_id = #{compId} and is_deleted = 0
        and mobile != #{mobile} and partner_type = #{partnerType}
    </select>
</mapper>